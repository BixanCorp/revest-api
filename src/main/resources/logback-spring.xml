<?xml version = "1.0" encoding = "UTF-8"?>
<configuration>
	<property name="LOG_DIR" value="/tmp"/>
	<appender name="STDOUT"
		class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>[%d{yyyy-MM-dd'T'HH:mm:ss.sss'Z'}] [%c:%L] %-5p %m%n</pattern>
		</encoder>
	</appender>

	<appender name="FILE"
		class="ch.qos.logback.core.rolling.RollingFileAppender">
		<rollingPolicy
			class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<fileNamePattern>${LOG_DIR}/finetl-%d{yyyy-MM-dd}.log</fileNamePattern>
			<maxHistory>30</maxHistory>
			<totalSizeCap>3GB</totalSizeCap>
		</rollingPolicy>
		<triggeringPolicy
			class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">
			<maxFileSize>3MB</maxFileSize>
		</triggeringPolicy>
		<encoder>
			<pattern>[%d{yyyy-MM-dd'T'HH:mm:ss.sss'Z'}] [%c] [%L] [%-5p] %m%n</pattern>
		</encoder>
	</appender>

	<springProfile name="localdev | dev | test">
		<logger name="com.bixan.songinfo.controller" level="trace" additivity="false">
			<appender-ref ref="FILE" />
			<appender-ref ref="STDOUT" />
		</logger>
		<logger name="com.bixan.songinfo.client" level="debug" additivity="false">
			<appender-ref ref="FILE" />
			<appender-ref ref="STDOUT" />
		</logger>
		<logger name="com.bixan.songinfo.concurrency" level="debug" additivity="false">
			<appender-ref ref="FILE" />
			<appender-ref ref="STDOUT" />
		</logger>
		<logger name="com.bixan.songinfo.interceptor" level="debug" additivity="false">
			<appender-ref ref="FILE" />
			<appender-ref ref="STDOUT" />
		</logger>
		<logger name="com.bixan.songinfo.operations" level="debug" additivity="false">
			<appender-ref ref="FILE" />
			<appender-ref ref="STDOUT" />
		</logger>
		<root level="info" additivity="false">
			<appender-ref ref="FILE" />
			<appender-ref ref="STDOUT" />
		</root>
	</springProfile>
	
	<springProfile name="stage">
		<root level="info" additivity="false">
			<appender-ref ref="FILE" />
			<appender-ref ref="STDOUT" />
		</root>
	</springProfile>
	
	<springProfile name="prod">
		<root level="error" additivity="false">
			<appender-ref ref="FILE" />
			<appender-ref ref="STDOUT" />
		</root>
	</springProfile>

	<springProfile name="localdev | dev | stage | prod">
		<logger name="org.springframework.boot.autoconfigure"
			level="error" additivity="false">
			<appender-ref ref="FILE" />
			<appender-ref ref="STDOUT" />
		</logger>
	</springProfile>
</configuration>
